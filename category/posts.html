<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>The left side of the bell curve - posts</title>
        <link rel="stylesheet" href="http://bwengals.github.io/theme/css/main.css" />
        <link href="http://bwengals.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="The left side of the bell curve Atom Feed" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://bwengals.github.io/">The left side of the bell curve </a></h1>
                <nav><ul>
                    <li class="active"><a href="http://bwengals.github.io/category/posts.html">posts</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://bwengals.github.io/gp-speedups.html">Structure exploiting methods to speed up gaussian processes</a></h1>
<footer class="post-info">
        <abbr class="published" title="2076-05-28T20:52:00-08:00">
                Published: Thu 28 May 2076
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="http://bwengals.github.io/author/me.html">me</a>
        </address>
<p>In <a href="http://bwengals.github.io/category/posts.html">posts</a>.</p>
<p>tags: <a href="http://bwengals.github.io/tag/gaussian-processes.html">gaussian-processes</a> </p>
</footer><!-- /.post-info --><style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>---
layout: post
title:  Structure Exploiting Methods to Accelerate GP computations
date:   2017-05-27 10:30:00
---
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This post is an outline of potential strategies to speed up GPs that could be implemented in PyMC3.  Since many of these changes are at the linear algebra level, they may require new Theano Ops.</p>
<p>Gaussian Processes in general have a computational complexity of $\mathcal{O}(n^3)$.  Show math and basic algorithm to compute likelihood and prediction.</p>
<p>The complexity of the Cholesky Decomposition is $\mathcal{O}(\frac{1}{3} n^3)$.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># add pymc3 master to path</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">"/home/bill/pymc3/"</span><span class="p">)</span>

<span class="c1"># do imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pymc3</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">theano</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>These set of methods exploit structure in the covariance matrix (or kernel) to speed up the solve operation.  Depending on the problem, these methods can be combined.</p>
<h2 id="Toeplitz-structure">Toeplitz structure<a class="anchor-link" href="#Toeplitz-structure">¶</a></h2><p>Each diagonal of a Toeplitz matrix is constant.  For instance, the following matrix is Toeplitz:</p>
$$
A = \begin{bmatrix}
a & b & c & d & e \\
f & a & b & c & d \\
g & f & a & b & c \\
h & g & f & a & b \\
i & h & g & f & a 
\end{bmatrix}
$$<p>If a stationary covariance matrix is used, such as the Matern and Exponentiated Quadratic, and the inputs <code>X</code> are evenly spaced and one dimensional, then the resulting covariance matrix has Toeplitz structure.  An example of a covariance matrix with Toeplitz structure is shown below.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">50</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span>
<span class="c1"># define and evaluate covariance function</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">function</span><span class="p">([],</span> <span class="n">pm</span><span class="o">.</span><span class="n">gp</span><span class="o">.</span><span class="n">cov</span><span class="o">.</span><span class="n">Matern32</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)(</span><span class="n">X</span><span class="p">))()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"inferno"</span><span class="p">,</span>
              <span class="n">interpolation</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span>
              <span class="n">extent</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="p">)));</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
APfe3z64vSd59zXc973X8G+Y49ieHsf29Di2p8exPT3XfGzbQX4CAFtSRQkABU49gFtrt7fWHjms
qnzf89yuyvIaTRzbXzg8pp9qrX20tfaGinWeR6Nje2S7n2it7bXW3rrl+s6zmWPbWntza+3jrbWH
W2t/vvUaz6uJ54TvaK39UWvtE4fH1u/sTDi1Sube+6n9ycH7M//vJD+Q5IYkn0hy61XbvCXJH+fg
Hbt/Kslfn+aaduXP5LH9V0m+8/Dvdzi2647tke3+Zw5+EfGt1es+D38mz9tXJ/lMku87/Pi7q9d9
Hv5MHtv/mOTXD//+XTloObyheu1n/U+Sf53kx5J8+gVuv6YcO+1XwG9McrH3/mjv/VKS+3NQXXmU
KstrMzy2vfeP9t6/evjhx3Iwo83YzHmbJL+S5PeTfHnLxZ1zM8f2HUk+3Hv/QpL03h3fOTPHtid5
VWutJXllDgJ4b9tlnj/9lCqZTzuAZ2oqVVlemxd73H4pB1dojA2PbWvtxiQ/H28+8mLNnLc/lOQ7
W2t/1lr729baOzdb3fk2c2x/O8mPJPm7JJ9K8qu99/1tlrfTrinHNq2ipEZr7adzEMBvql7LDvnN
JO/tve8fvJhgoZcl+fEkP5vkW5P8VWvtY733z9Uuayf8XJKPJ/mZJD+Y5E9ba3/Ze3+ydlkvTacd
wDM1ldNVlnyTqePWWvvRJB9Mckfv/YmN1nbezRzb25Lcfxi+r03yltbaXu/9D7ZZ4rk1c2wfS/JE
7/3pJE+31v4iyRuSCODjzRzbdyX5z/3gPy4vttY+n+T1Sf7XNkvcWdeUY6f9I+iHktzSWru5tXZD
krfloLryKFWW12Z4bFtr35fkw0l+0auHF2V4bHvvN/fev7/3/v1J/luS/yB8p8w8J/xhkje11l7W
WntFkp9M8tmN13kezRzbL+TgJwtprX1PDt5I4NFNV7mbrinHTvUVcO99r7X2niQfycFv6N3Xe3+4
tXb34e2qLK/R5LH9tSSvSfI7h6/U9rpC9qHJY8s1mDm2vffPttb+JMknk+wn+WDv/Vy8c1qlyfP2
/Uk+1Fr7VA5+Y/e9vXfvQDVwWpXMmrAAoIAmLAAoIIABoIAABoACAhgACghgACgggAGggAAGgAIC
GAAK/F90ZWL42+bVkAAAAABJRU5ErkJggg==
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To include in PyMC3 this would require a new Op and gradient to be implemented (eventually, preferably) in Theano. This may also benefit some time series methods.</p>
<h5 id="References">References<a class="anchor-link" href="#References">¶</a></h5><ul>
<li><a href="https://arxiv.org/abs/1503.01057">KISS-GP</a></li>
<li><a href="http://icml2008.cs.helsinki.fi/papers/151.pdf">Cunningham et al.</a></li>
<li><a href="http://www.math.niu.edu/~ammar/cortona/node3.html">Fast Cholesky Factorization</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Kronecker-Structure">Kronecker Structure<a class="anchor-link" href="#Kronecker-Structure">¶</a></h2><p>It may be possible to exploit Kronecker structure if the number of $X$ dimensions is greater than 1.</p>
<p>The product of two covariance functions is also a covariance function, even if the inputs are over different spaces.  For example, in the two dimensional case, $k = k_1(x_1, x_1') k_2(x_2 , x_2')$ is a valid covariance function.  If the number of $x_1$ data points is $n_1$, and the number of $x_2$ data points is $n_2$, then the dimension of the $k$ <strong>matrix</strong> will be $n_1 n_2 \times n_1 n_2$ (large!).</p>
<p>Fortunately, the matrix $K$ can be written in terms of a Kronecker product, $K = K_1 \otimes K_2$, and the inverse of a Kronecker product is equal to the Kronecker product of the inverses, $K^{-1} = K_1^{-1} \otimes K_2^{-1}$.</p>
<p>For example, in a two dimensional scenario, this reduces complexity from $\mathcal{O}((n_1 n_2)^3)$ to the much faster $\mathcal{O}(n_1^3) + \mathcal{O}(n_2^3)$.</p>
<p>The full matrix $K$ has an apparent blocked structure, as shown below.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span>
<span class="n">K1</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">function</span><span class="p">([],</span> <span class="n">pm</span><span class="o">.</span><span class="n">gp</span><span class="o">.</span><span class="n">cov</span><span class="o">.</span><span class="n">Matern32</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)(</span><span class="n">x1</span><span class="p">))()</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">kron</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">K1</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"inferno"</span><span class="p">,</span>
              <span class="n">interpolation</span><span class="o">=</span><span class="s1">'none'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$K = K_1 \otimes K_2$ has no diagonal noise term.  If we add a diagonal noise term, $K' = K_1 \otimes K_2 + \sigma^2 I$, then the <code>eigh</code> routine can be used instead of the Cholesky to decompose individual matrices instead of the Cholesky, and the speedup is still obtained.</p>
<p>I think an implementation in PyMC3 would be best done within the <code>GP</code> class.  Perhaps if the <code>cov_func</code> argument was given a list of covariance matrices and a list of inputs, the <code>GP</code> class would be able to sort it out.  For instance, something like</p>
<pre><code>gp = pm.gp.GP('gp', cov_func=[k1, k2, k3], inputs=[x1, x2, x3])

</code></pre>
<p>might work.</p>
<h5 id="References">References<a class="anchor-link" href="#References">¶</a></h5><ul>
<li><a href="https://pdfs.semanticscholar.org/e08f/8db209278eabd13a6b9966e14d10c924b704.pdf">Saatchi Thesis</a></li>
<li>KISS-GP</li>
<li><a href="http://sethrf.com/files/fast-hierarchical-GPs.pdf">Fast Hierarchical GPs</a></li>
<li><a href="https://papers.nips.cc/paper/4281-efficient-inference-in-matrix-variate-gaussian-models-with-iid-observation-noise">Efficient Infernce in Matrix-variate ...</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SKI-(Structured-Kernel-Interpolation)">SKI (Structured Kernel Interpolation)<a class="anchor-link" href="#SKI-(Structured-Kernel-Interpolation)">¶</a></h2><p>is described in the KISS-GP paper.  This method is a generalization of inducing point methods, such as SoR and FITC.  This method doesn't exploit matrix structure directly itself, but gridded inducing points can be used to produce approximate covariance matrices with Toeplitz and/or Kronecker structure.  The idea is to approximate the true covariance matrix with an interpolated covariance matrix.</p>
<p>First a grid of $m$ inducing points $U$ over the domain of $X$, which has $n$ data points. The kernel matrix computed at the inducing points is denoted $K_{U,U}$.  The true covariance matrix $K_{X,X}$ can be approximated as
$$
K_{X,X} \approx W K_{U,U} W^T
$$
where $W$ is a matrix of interpolation weights.  Depending on the interpolation scheme used, $W$ can be very sparse.  For example, if $W$ represents local cubic interpolation, each row of $W$ will have 4 non-zero entries.  It isn't strictly necessary for the inducing points to be regularly spaced or on a multidimensional grid.  However, placing them on a grid enables special matrix inversion methods for Kronecker and Toeplitz structured matrices to be used.  The complexity of SKI depends on the number of inducing points used and how they are structured.</p>
<p>The authors refer to SKI+Toeplitz+Kronecker as KISS-GP. It is implemented in the GPML version 4.0 MATLAB package.</p>
<ul>
<li><a href="https://arxiv.org/abs/1503.01057">KISS-GP</a></li>
<li><a href="http://www.gaussianprocess.org/gpml/code/matlab/doc/">GPML V4.0</a></li>
<li><a href="https://arxiv.org/abs/1511.01870">Wilson et al. 2015</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-HODLR-solver">The HODLR solver<a class="anchor-link" href="#The-HODLR-solver">¶</a></h2><p>Many common covariance functions produce hierarchical off-diagonal low-rank (HODLR) covariance matrices, pictured below.  The HODLR solver can be applied to speed up inversion and determinant computation to $\mathcal{O}(n log{}^2 n)$ time.  The algorithm can be applied in a black-box fashion, and works best on lower dimensional problems where $d < 3$.  Periodic covariances, for instance, are not HODLR.</p>
<p>A low rank matrix is one with small eigenvalues that can be approximated as
$$
K \approx Q_{n \times p} D_{p \times p} Q^T_{p \times n}
$$
with $p < n$.</p>
<p><img alt="caption" src="hodlr.jpg" /></p>
<p>The HODLR solver uses fast low rank factorizations of off diagonal blocks, and usual full rank solvers for diagonal blocks.</p>
<p>Below shows that the <code>Matern32</code> covariance is HODLR.  The GP library George contains bindings to the HODLR solver.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)[:,</span><span class="kc">None</span><span class="p">]</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">theano</span><span class="o">.</span><span class="n">function</span><span class="p">([],</span> <span class="n">pm</span><span class="o">.</span><span class="n">gp</span><span class="o">.</span><span class="n">cov</span><span class="o">.</span><span class="n">Matern32</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">)(</span><span class="n">x</span><span class="p">))()</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mi">1</span><span class="n">e</span><span class="o">-</span><span class="mi">6</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"inferno"</span><span class="p">,</span>
           <span class="n">interpolation</span><span class="o">=</span><span class="s1">'none'</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">K</span><span class="p">[:</span><span class="mi">50</span><span class="p">,:</span><span class="mi">50</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"inferno"</span><span class="p">,</span>
           <span class="n">interpolation</span><span class="o">=</span><span class="s1">'none'</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="mi">50</span><span class="p">:,:</span><span class="mi">50</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"inferno"</span><span class="p">,</span>
           <span class="n">interpolation</span><span class="o">=</span><span class="s1">'none'</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"K"</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"upper left block"</span><span class="p">);</span> <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"lower left block"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Rank of K:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">K</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="n">tol</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rank of upper left block:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">K</span><span class="p">[:</span><span class="mi">50</span><span class="p">,:</span><span class="mi">50</span><span class="p">],</span> <span class="n">tol</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Rank of lower left block:"</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">K</span><span class="p">[</span><span class="mi">50</span><span class="p">:,:</span><span class="mi">50</span><span class="p">],</span> <span class="n">tol</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Rank of K: 100
Rank of upper left block: 50
Rank of lower left block: 2
</pre>
</div>
</div>
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAsMAAAD0CAYAAAB+bCt+AAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAIABJREFUeJzt3Xu4JVV55/Hve5puurkJBAZbQNtETKaTJ2LSYzDkQkQz
BI34OAmDEYcY85Dk0QkmJhHMxZjLSJ4YIzPmMj1ewNGgBo04xkkkRHDMxQSUMSg6aAS5NDcFge7T
p8/Z9c4fVfvsqtp712Vfqtbe9fs8z3nOWbWqdq19WXuves+71zJ3R0RERESki1baboCIiIiISFs0
GBYRERGRztJgWEREREQ6S4NhEREREeksDYZFREREpLM0GBYRERGRztJgWESkZWZ2g5n9dMV9zzSz
283scTN7UYX9d5mZm9lhY+p/08zeXbfNudv4STP75DS3ITKKmd1hZs9tux19Zf1pxP6/Y2YPmdl9
Ffcv7I+zeDzqvN90hQbDHZLvRGZ2gZk9bGY/2Ga7RKSW3wLe6u5HufuH9MEmEiYzezLwGmC3uz+x
7kBamqPBcEeZ2UXAHwHPd/cb226PSFeY2ZYpb+IpwOdm0RYRGW8Gg9YnA19z9wdm0R6ZHw2GO8jM
fgb4A+Dfu/vft90ekSYkEZmnpcpXmtnvJH+fZWZ3m9nrkn9p3mFmL83t+6dmdp2ZPWZmN5rZU1L1
35bUfd3Mvmhm5+eO/RMz+6iZ7Qd+qEJbf8rMbkv+c/PX/XOZ2ZeBbwb+V5Im8Ubg+4G3JuW3Ftzs
T5nZvWa2z8x+qeDcLzSzz5nZI0nU+d+m6k41sw+a2YNm9rVx5zOz3zezT5rZE8ruq0hVZna4mb0l
eR3fm/x9eFJ3o5n9h+TvM5P+/vykfLaZ3ZK6nZH9K6lzM3ulmd0O3F6hTU8ws7cn/eqeJC1iS/Jf
2OuAJyV980rgE8lhjyTbnj3mZreb2fuS95pPm9kz6j4eSf15ZnaLmT1qZl82s3NG3MZOM/usmf1y
2X1dZhoMd8/PEf+b9Wx3v6ntxogE5InACcDJwEXAXjP71lT9S4HfTva5BXgPgJkdSfyh92fAvwEu
AP7YzHanjv0J4HeBo4HC3FozOw94HfBi4ETg/wBXA7j7twBfBX40SZO4LKl/VVJ+VcFN/xBwGvDD
wGtH5R2a2dOTc706OfdHiQfe25KI9keAO4FdyeP03tzxK2b2P4DvBH7Y3b9RdF9FavpV4AzgdOAZ
wLOAX0vqbgTOSv7+QeBfgR9IlW+E4v6V8iLge4DdlLsS2ACeBjyTuH/9tLv/DfAjwL1J3/zJVHuO
Tbb9w5jbPA/4c+B44veVD5nZ1hH7jX08zOxZwLuAXwaOTc59R/pgM3sq8ePyVnf//Qr3dWlpMNw9
zwP+EfiXthsiEqBfd/e1JHXoL4HzU3V/6e6fcPc14g+hZ5vZqcALgDvc/Z3uvuHunwE+APx46thr
3f3v3D1y94MlbfhZ4I3ufpu7bwD/BTg9Hb2a0Bvcfb+7/wvwTuAlI/b5j8n9vM7d14E3ATuA7yX+
oH0S8MvJ7Rx09/TAfivxoOJ44sH6gSnbK5L3UuC33P0Bd38QeAPwsqTuRuJBL8QDvzemypuDYar1
rze6+9fdfbWoMWZ2EnAu8OqkTzwA/CHxBfE0bnb3a5I++GZgO/GgN6/o8XgF8I6kL0fufo+7fyF1
7G7g48Dr3X3vlO1deBoMd8/PAU8H3mZm1nZjRALysLvvT5XvJB789d3V/8PdHwe+ntQ/BfieJK3g
ETN7hPhD6omjjq3gKcAVqdv6OmDEkdhppNuQv299T0rqAHD3KDnuZOBU4M5kADHK04gjWm9w90NT
tlVklMzrk+zr+B+ApycD1NOJo6KnmtkJxBdy/RSFKv2ran99CvFF4L7U7f134v8QTSP9XhMBd1Oh
v5J9PE4FvlxwjpcC9wDXTNXSJaHBcPfcD5xNnGf4xy23RaRJB4AjUuUn5uqPS1Ie+p4M3Jsqn9r/
w8yOIo6A3kv8wXWjux+b+jnK3X8udazXaOddwM/kbm9HQX5/1ds+NfV3/r713Uv8AQ9AcsF8KvGH
5l3Ak238l4puA14O/O9ceonIrGRen6Rex8l/Im4GLgFuTS7I/h74ReDL7v5QckyV/lW1T90FrAEn
pG7rGHf/9jH71+6rZrYCnEKF/kq2X98FfEvBOX4TeAj4M5v+S70LT4PhDnL3e4kHxOeY2R+23R6R
htwC/ETy5ZZzGPwLNe0NSX7s9xOnP/x5qu5cM/s+M9tGnDv8j+5+F3Ee7dPN7GVmtjX5+XfpL57V
9KfAZWb27bD5BZ0fL9j/fuIv1ZX5dTM7IrndlwPvG7HP+4HnJ1842ko8LdQa8aDin4B9wOVmdqSZ
bTezM9MHu/vVxPmYf2NmRR/EIpO4Gvg1Mzsxifj+BpCek/dG4FUMUiJuyJWhfv8ay933AR8D/sDM
jkly5r/Fxk9X+iAQUd5fv9vMXpxceL6auA/+44j9ih6PtwMvT/ryipmdbGbfljp2nTiV60jgXcmg
u7M6fee7zN2/CjwH+DGLv5EusuwuAX4U6KcxfChXfx/wMHFk5T3Az+Zy7P4MeD3xv1W/G7gQwN0f
I/7SzAXJsfcBvwcczgTc/S+S499rZo8CtxJ/EWecK4j78cNm9l8L9rsR+BJwPfAmd//YiHN/kfh+
/TfiqNGPEuf/HnL3XlJ+GvGX+O4mzjHO38ZVxF/S/Vsz21V8b0Vq+R3gJuCzxN97+XSyre9G4i+p
fmJMeZL+VeY/AduAzxO/f1wD7By1YxK9/l3g75K0ilF5wADXEveth4lzgF+c5A/njX083P2fiC96
/xD4BvFjkfneQRI9fzFwEvCOLg+Izb3Of+9ERJaPmZ0FvNvdTxlTfyVwt7v/2qh6ERFZXJ29ChAR
ERER0WBYRERERDprqjSJ5EsoVwBbgLe5++WzapiIiIiIyLxNHBlOpuL4I+LE893AS3IrLolIYMzs
HIuXC/6SmV3adntEZDz1V5FmTJMm8SzgS+7+r8k3Et9LPOG6iARIF7Aii0P9VaQ54yZPr+Jksqu0
3E28lvdYJ5xwtO/adeLQdidK/vCknKRueJStj3qZ7eb943Lbo/z+ye1FUfyT2db/vdmYpGzJbiu5
cvI7V8aL6/O/I8bU95uR24/NZvb3zzbXx233XP3IY/P7jt7e3zJUv7lfNuXGc/tvHm/5+uwtDe0/
VD/6PIMNo/cbfXzuTg+1Ibdf5XLZ8ZsecvfhTjEfmxewAGbWv4D9/Kidx/XXvuHHPSqp72WLuf3z
9RalytHG+DoY9PXNclSv3Mu1NVdNlI0b9Pv3oJyvL94/Kqv3ldTf4+sg9R6U6A3tny9TXE9xfT6z
bnj/fDm7YXj/fH2uf9vgiB7511j2eY/y9UOvyfxrMN8vc6+j4X4bbH8F2LGyw4/ZcsxmOb/GaH7J
Ucvdv9L9h+pzxxfsu1J6rnz9+NseWZ8rD5+vZnmluJ6C40uPHaqPCuuHwpb5B2Ml/2DnH9zcDazk
ykNPVnYNDh/aP1/O7Z+uHzp3dl/L37nc/pa/s2X1OTff/JVKfXaawXAlZnYxcDHAk5/8TXzqn397
aJ9etAZAlKzyGfUOxr+j5PfG4/GO648lv+PyyqF45VRbezQpx8uIrxxMtm/+Xh38Xj0Q38bBZLXQ
tficnmz2tfiJita2xr9X46lCe0m5dzApH4rLG/3fa9vipvXL6/FDe+hQsn0jLq+vx/WHekl9f3u/
3NuS+b2WbN9IPjzXkt/jy/ELYz35vdEve397qi7pb+vR6N+95INiqJz87uV+ryeDmY3kTahHvxxl
y9ZLyhtJeSNT7n+g9Ww9u937x8Xb+xdJPR9TTvYf3j64yNr8e3NbL1Puf3R7/sIstz9D2/Mfovmr
rb7enTSn1gXsrl0njuyvfVFuVd5+P96sT/rxZn2/Hyc8V2bt4UxxZe0bg79Xc3UHHi0s24H92fL+
x7LnevxAtrw/e1+i/Su58vZMeeNArvz4jkx5fTU7xfChA9n6tYPZ+oOr2ds7uDaoXz2U3Xd1fVuu
vDVT3p+v38i+ze/PlQ/0svd1NVc+sJGvt1w9uXrP1WfLB3MXIgdyFzqrZFdyPmiD19F+y75mDpIt
r3m2fCjKlXvZ10UvWs2Vs/XDq0qH218BjtlyDBeccMFmeWtuULU1N+7YmhukHTa0f7Z8+Ep+/yhX
H1WqA9i2JXvhsXWlV1g/tP+W7Otm22G5cq5+69bsNL1b8/tvyz7Xh23NHb8te/xhh+f2T9Vvye27
ZXv2vXHL4dn6lR3Z+pVcve3IBQqybxdweG4od0Ruh8OzZd++o6R8ZKYc5cvbcvsffkyuPrX/1qOy
bdl6dKa4cli2fmUl29aVLdnylpXs++HK2AUxY4etXFipz04zGL6H7PKepyTbMtx9L7AXYM+ebx4Z
Htu8c/2+krvz/VYORRSS3yuMrh+VAzLuGsLov/B7Y49tV9WnakzLNx8sYxBmtsJDBvW5/cdKrvg2
I3xjVnjsvwpsTLn/XPjW7Pbc/v1B8RZLLlQ8V86db7B9fbA9f5dybekHjix37n6wrP9ZsvnC3tye
HxTnX6Vhzu+dv3gVkbCl++zRK0eX7C0io0wz5vtn4DQze2qyPOkFwIdn0ywRmYPSC1h33+vue9x9
z4knZq/2RaRRlQNO/T67Y2VHvlpEKpg4MuzuG2b2KuCviUOA73D3z03TGEWIq5hBhHglF+bscoR4
6Jyj2zK/CHGjNi9giT9ULwB+YtIbG/r3VM3OUpadOc0jVNaU4VdwNm1ihdz//smmfMw9v6xRde9N
WQJjyfvDRv743PnzT3zRP1HKTl3yQsgnQeT18mntvjp6x/mo3V+dQfobMOK9Op+Lmquv3enC+4Rc
RsOPci5touT9Kq/sE7z8/FlFY66yl9RQ/ZRvR2VpE+NM9Z7u7h8FPjrNbYhIM+ZxASsi86H+KtKc
RgMcTkQvWhtKgM5ThLiKKSLEmfxh6HKEOJM/nDnn6LbMPkLcLF3AiiwO9VeRZoQ3xhMRERERaUiz
qW/u8XRMSWSyjQjxuNG/IsTQxQjxyBkmMucc3ZbZRYjD5Xhm+rSyXKx55hBPm2GtHOI6As4hLus2
c84h3ug1mjNcmzOYChMYvr/KIV4Ki5RDPPQSrHEsMP3b0XwPExERERFZfA3nDHs8EX8/wqsI8Qwp
QjxRhLhoDuLMOUe3ZfoIsYiIiLQpvDGdiIiIiEhDGs4ZjjaXWAZaiRBXmWEClj1CXGWVOuhChLjS
KnWZc45uy6QR4qBDwx5ll1iuOZ/jLHOIZzkHcZWmKIc4LaAc4jpzEFc5dc0c4o18Yntg3HM5w3mN
5hCH9+m4rELOIS4bc809h7givVpFREREpLMan2c42nh8+KwNRojrzEEMihDHljdCXGmVupHnHN2W
2hFiERERaVV4YzgRERERkYY0m9oW9WD9sUFUtoUI8SSr1IEixLHlixBXWaUufUyXIsSbs7+M02AO
cdEcxKAc4ma1mUNcMAcxzD2HeG295PZbNjTPcBnlEC8l5RDXp1eniIiIiHRW47NJsP74ZlER4iYp
QjwqQlxllbrs9tlGiIMODYuIiHRAeGM2EREREZGGNBoZNo9YObR/7DzATUSI66xSl96epwgxLEOE
uNIqdanbnnWEOGjeo7fxePl+fcohTh2vHOLxpsghLpqDGBrPIQ6NAz1P3enS99oc5RAvpTZziMue
5VByiPVqFBEREZHOajhnuIetPTo2CttIhLjCKnWj6pcrQlz1ae9AhLjCKnVxffa2ZxYhFhERkVaF
NUYTEREREWlQ47NJrBxaLY3CKkLcFEWIq6xSlynnzjVthDhk7hGeyhnO5+mWUg5x6njlEI+3QDnE
gXPPzTO8krvDTeYQ1+50YX06LrNO5RBXpFefiIiIiHRWs7NJRBErB/dvlluJEFeYg7hK2xQhTlnk
CHGFVepgfhFiERERaVdYYzIRERERkQY1m6oW9bCD+8fmgDQSIa6xSl2VtilCnLKIEeIKq9TBHCPE
IfMerD08KOaqG80hrtlRlEMcklnmEJe8N8w7hzh4XjzPcJM5xFPNQTzqZDIvy5xDPKt2iIiIiIgs
rYZnk3Ds4OpmsY0IcZVV6orOrQhx2jJEiMtXqYM5RohFRESkVWGNwUREREREGtRwznCUiQz3KUIM
ihCnj2swQlxllbrUsV2KEFvUY2XtG5vlsnTLeeYQTzMHMSx2DvFy5Q/DdDnENScCnnUOceAcWC+a
xLzRHOKCOYhBOcQBm2UOcd2PurZyiBsfDLN6YOyDo0ExaFCcPq6BQXGdpZtTx85sUCwiIiKtCmvM
JSIiIiLSoMa/QMfBQ5tFRYhHbVeEePi4OUaI6yzdzPD+U0eIQxZtsLL68PjqXFlpEwOzTZtY5mnX
oN49mmLpZlj6tAmH7NRqZeaZNlFn6WZQ2kTAFjltYlbnERERERFZWqWX5GZ2KvAu4CTiS7u97n6F
mR0PvA/YBdwBnO/u48NIAJHDWv4KotkIca2lm9PH5m5bEeIqFiBCXGfp5vT2GUWIRUREpF1Vxlgb
wGvcfTdwBvBKM9sNXApc7+6nAdcnZRFpmZm9w8weMLNbU9uON7PrzOz25PdxbbZRRGLqryLtKw3x
ufs+YF/y92NmdhtwMnAecFay21XADcBrC28sAj8wKr8k1kiEuM7SzekbU4R4BEWIp40Qz8mVwFuJ
/6PT1794vdzMLk3Khf3Voh4rBx6tfNJ55hDXWro5d2wVIecQd2vpZgg6h3g+rmQG/RUmyBnOm2UO
cZ2lm0E5xAukXg7x7JZuHn3urEm7bK1Xj5ntAp4JfAo4KRkoA9xHnEYx6piLzewmM7vpoccX7NsI
IgvI3T8BfD23+Tzii1aS3y9qtFEiMpL6q0j7Kl+Cm9lRwAeAV7v7o2aD8by7u5mNHOm6+15gL8B3
n7rivraF/lVEKxHiGjNMZOoVIS6gCPHEEeLmVL54BS4GOHXntoaaJiI5lforZPvsdjuqgaaJLJ9K
Yyoz20o8EH6Pu38w2Xy/me1M6ncCD8yniSIyS+7ujEnUcPe97r7H3feceKy+5CfStqL+mtRv9tmt
tqPBloksjyqzSRjwduA2d39zqurDwEXA5cnva0vPFhnR2tbUCFwRYkWIU1qJENdYujldnlGEuEH3
m9lOd99X+eK1Zs7w0OG58lQ5xDXmIB5Zv9A5xNWXbgblEGfNOIe4OfX7K+DurHv61Tvm/a0q5RBL
BUU5xHXmII73n/bck6lyO2cCLwOeY2a3JD/nEg+Cn2dmtwPPTcoiEqb+xStUvXgVkbaov4o0qMps
Ep9k/GD97Donc18hWh1EYFuJEE+xSl2mXhHiAgsUIa6ySh3MLUI8D2Z2NfFMLyeY2d3A64kvVt9v
Zq8A7gTOn1sDRKQy9VeR9i3ff9REOs7dXzKmqtbFq4jMn/qrSPuaHQxHRm9tOFeyyQhxlVXqQBHi
2ViECHGFGSZSp551hDhoUYQd2L9ZnPa1pRzi8YqaUzQHcXxsl3KI696bWecQh28j/er0/CtXOcQy
f9lHumgOYgglh1ivDhERERHprEaDBu5G7+D4iKsixAOKEKcscYRYRERE2hXWmElEREREpEHNRoYj
o3eoPFdynhHiSnMQgyLEc6EI8dD+IYsibP9jY6uVQzygHOK2NJxDHDjH6VEwz3CTOcR18odBOcRL
qmgOYph/DnFVejWIiIiISGc1njO8USEy3DePCHGtVepAEeK5UIR4wQNQIiIiSyOsMZKIiIiISIOa
TR9zY2NtW+3DZhkhrrRKHShC3IgAIsRVVqmD+UWIQxZF8PggH7WsyfPMIa6VPwxLlUNc1hTlEKd1
O4fYgY3CV1uDOcTTzEEMyiFeUqHmEOvZFxEREZHOajxneL1GznCeIsQD00SIw7sCajFCXCl/GOYW
IRYREZFWhTcuEhERERFpSOPzDG+sT3/KaSLEdVapy5SXKkIcYv4wtBIhrjXDBMw8QhyynsP+dDuz
uahN5hBPNQcxKIc4c7xyiMcryyEOXX6e4TJzzCEumoN4VH0Z5RAvpVByiPVsi4iIiEhnNZ4zfOhQ
/dkkxlGEeKBOhDjsGSagWxFiERERaVN44yARERERkYY0P5vExuxPqQjxgCLEKYsQIQ5ZBNH+wYM0
nGvaXA5x0RzEoBziIsohTps2hzhsbrBhqVdb7fcZ5RBXP6HMw6xziCc/r4iIiIhIRzQfGV6f3/yq
VSLEVeYgBkWIwzLHCHGVVerS5bEmjBCLiIhIq8Ib94iIiIiINKTRyHCEcag3/1MqQjww6mqnyip1
445t1xwixFVWqYP5RYhDFq0Q7U+/DrO5WcohHn98GeUQh2K57o3j9NLPX0kabTnlEFc/ocxDUznE
ejZFREREpLOan2d4DrNJjKMI8YAixCmZCHGFGSYy9TOOEIuIiEirwhvniIiIiIg0pPnZJBrIGc5L
R4jrzEGcPTamCHFIZhAhrjMHcaZ++SPEHhkbBwavu+FHWznEY+tnmEM8Tf5wlaYohzhtse+N42zY
RnpDlnKIU5RDvIjq5xBPersiIiIiIh3RbGQYONRrLzIWj/zrr1I3OHZgkSPEdeYgjrcvcYR4klXq
MvXLHyEWERFZZuGNa0REREREGtL8bBItRoah2gwT8fay42OKEIdkESPE4fJohY3Hd4ytVw5xwe4z
zCGe5RzEVZqiHOK0Rbs3NecZnmsO8ZSf9QudQxzep+OyKsshnvx2xjCzLWb2GTP7SFI+3syuM7Pb
k9/HTdQCEREREZGW1LnsvQS4DTgmKV8KXO/ul5vZpUn5tUU3EGGstTCbxChdjhBXmWECFCGOzTlC
PGNmdirwLuAk4sbvdfcrzOx44H3ALuAO4Hx3f3gujRCRytRnRdpXaRxjZqcAzwfeltp8HnBV8vdV
wItm2zQRmcAG8Bp33w2cAbzSzHYzuHg9Dbg+KYtI+9RnRVpWNYT2FuBXgKNT205y933J3/cRX9UW
c9iIVmqcdv66GCGuMwcxLHuEuMoqdTC/CPFsJX1yX/L3Y2Z2G3Ay8cXrWcluVwE3UPKfHI9WWF8t
fh2mzTOHeNrX1iLnEBfNQQzKIV50M+2zQJR5ReSemyZziGc5BzEoh1gqmfSRLj3OzF4APODuN4/b
x92dMd3GzC42s5vM7KZHewdH7SIic2Bmu4BnAp9ikotXEWmU+qxIO6pctJ8JvNDMzgW2A8eY2buB
+81sp7vvM7OdwAOjDnb3vcBegF07TvS1KD3+Didm0KUI8SSr1IEixLHFiBCb2VHAB4BXu/ujZoPz
u7ub2diLV+BigFOOCqd/iiy7WfTZw2z87C8iMl7puMXdL3P3U9x9F3AB8LfufiHwYeCiZLeLgGvn
1koRqczMthJ/qL7H3T+YbL4/uWil7OLV3fe4+55v2q7BsEgTZtVnV2xbMw0WWTLTfNpdDrzfzF4B
3AmcX3aAb+YMz7IZs6UI8YAixCkLEiG2OJz0duA2d39zqqp/8Xo5FS9ePTIOHZg80qQc4oLdlUMs
iVn2WXB6tp4qbs3VN5lDXDQH8Yj6upRDLJWsVtqr1vuSu99AnMSPu38NOLtmq0Rkvs4EXgb8i5nd
kmx7HRNcvIpII9RnRVrW7Ap0wNrIyHBfODGDZY4Q11mlLr09TxFiCC1C7O6fZPxTo4tXkcCoz4q0
L7xxioiIiIhIQxqODNuYnOE8RYjnGiGusErdqHpFiFNmFSEOWBStsHaw+jzDZabJIS6LoyuHeEA5
xN3lOL304z2U9qoc4sqmySGu3enC+3TsGj0DIiIiItJZzUaGHdYio/oYPJyYgSLEA8sVIa76GptT
hFhERERaFda4RERERESkQY3PJrGeiYgpQtxKhLjCHMRV2qYIccqkEeKAeWQcXN1evuOE6uUQV5+D
OD52OkHlENe8M8oh7jInSufi5p8M5RCPry9TJ4d4qjmIR51M5k2PuIiIiIh0VuM5wxsjr8YUIW40
QlxjlboqbVOEOGUJI8QiIiLLTB/NIiIiItJZjc8zvO5WkD+jCHETEeIqq9QVnVsR4rTljRBHvsLB
tdnNM1ymKIe4aA5iWO4c4mnmIAblEHdJPM/wenpDVpM5xLWnUl+mHOKCOYhBOcQB0iMsIiIiIp3V
wmwSDK6SFCEecXxMEeJQzDlCLCIiIq1q/At08dRqyYBAg+KC42MaFIdiToPigEVurB5qLk0iL/uI
V1+6GZQ2UWSR0ybCeacPl6eewUzKRFyZNc+0iammXYOFTpuos3QzKG0iAHpERURERKSzGk+T2HBS
V02KECtCPGp7lyLEIiIi0qawxhkiIiIiIg1q6Qt0yQZFiDc1GSGutXRz+tjcbStCXEVJhDhgka+w
ur6t7WYAdZduhmXKIa61dHPu2CoWK4dY064VcZyeD/KEt1g257fRHOKZLt0MC5VDXGfpZlAOcQD0
CIqIiIhIZ7Uwm0RqgyLEQxqJENdZujl9Y4oQjzBlhFhERERapU9oEREREemsdnKG8xQhHjLXCHGN
GSYy9YoQF1i+CLG7sbqezxEMQ6dyiGvMQTyyfolyiLV0c7nMPMOezRFuNIe4ztLNo+pLKYe4+gml
jB4xEREREemsxiPDPffxV1SKEA9RhHjUdkWIRUREZDb0iSwiIiIindXObBL93JtWIsThRIehpQjx
FKvUZeoVIS4Q1utsEj039gcyz3AZ5RAX7L5UOcRFcxBD53OIvWSe4UZziAvmIK5y28ohTu2vHOJ5
0yMkIiIiIp3V8IWzZ3OGFSHe1GSEuMoqdaAI8WyE9ToTERGRrLDGDSIiIiIiDWp+nmFP5cIoQjxE
EeIBRYjbFbmxurF47QblEBfuvsA5xEVzEMfHdjuH2HE8lSs7lDXbZA5x0RzEo45dphziOvnDoBzi
AFR6RMzsWDO7xsy+YGa3mdmzzex4M7vOzG5Pfh8378aKiIiIiMxS1QvlK4C/cvcfM7NtwBHA64Dr
3f1yM7sUuBR4bdGNbM4znKcI8ZB5RogrzUEMihDPxXxfZ2a2HfgEcHhysmvc/fVmdjzwPmAXcAdw
vrs/PNeEedhSAAAS30lEQVTGiEgp9VmR9pWOE8zsCcAPAG8HcPdD7v4IcB5wVbLbVcCL5tVIEals
DXiOuz8DOB04x8zOIL5Yvd7dTwOuT8oi0j71WZGWVQlTPRV4EHinmT0DuBm4BDjJ3fcl+9wHnFR2
Q2Mjw32KEA+ZR4S41ip1oAjxXMzndebuDjyeFLcmP0588XpWsv0q4AZK/pMTOexf0JzhvEXOIa6V
PwzKIc4cG34O8Sz7LICnH/Hck9FoDnHhHMSw1DnE08xBDMohbkHV0eF3AX/i7s8E9pO7Qk0688iX
ppldbGY3mdlN6746bXtFpISZbTGzW4AHgOvc/VNMcPEqIs1QnxVpV5UL47uBu5POCXAN8WD4fjPb
6e77zGwncSce4u57gb0AR6+c6Oveo/QKbK4R4qpXQCHEDAZmGSGutEodKEK8oDz+OvnpZnYs8Bdm
9h25ejezsRevwMUAxx121NzbKiKz67MW2OeWyKIoHRe4+33AXWb2rcmms4HPAx8GLkq2XQRcO5cW
ishEktz+jwPnkFy8ApRdvLr7Hnffc1T+4kVE5mraPmslKTEiMlrVnvOfgfckM0n8K/By4oH0+83s
FcCdwPlVbmgDT+XqKEJclyLEA4oQDzOzE4F1d3/EzHYAzwN+j8HF6+VUvHiN3DjQSz9KYfWFaSxS
DvFUcxDDUuUQlzVlEXOIZ9ln41VeB3m9+ZzfRnOIi+YghuXOIS6ag3hUfRnlEM9dpb7v7rcAe0ZU
nT3b5ojIlHYCV5nZFpILVnf/iJn9AxNcvIrI3KnPirSs4RXonB6pnGFFiCc2TYS4zip1mfISRoiX
7frX3T8LPHPE9q+hi1eR4KjPirRv2cYCIiIiIiKVNRwZho1MXK+FCPFUcxCDIsQsWYR4efOHpxUB
q72iRyasvjCNkHOIi+YgBuUQF1nEHOJpOI774BHN5/Q2mkNcluOrHOLx9WWUQzxzy38PRURERETG
aPjCt58znNdghHgmq9RBaDEDRYgH6kSIuzDDhIiIiIynz34RERER6axmc4YNNqxXkMvTRIS4ygwT
6YPKLF6EuMocxKAIcddFbhzYqPNIhNUXpqEc4oLdO5xDvAg8/QgO5QQ3l0NcOAcxKIc4TTnErVu+
eyQiIiIiUlEL8wxvDK7Y2ogQ15qDuH9QFWFFxRQhHlCEWERERMbRZ72IiIiIdFbjkeEN2xhEhNuI
EE+0Sl36wDKKEC9ShLjKKnXjjl127rDaSz9CdR+FsPrCNJRDXLB7p3KIQ5edZ7gsb3aeOcSFcxCP
uG3lEKcoh7hxi38PREREREQm1MI8wyNyhhUhnrt0hLjOHMTZY2OKEIuIiMiy0Ge7iIiIiHRWwznD
EBGxmeujCHHj4lbXX6VucOyAIsTLLQIOZF4i+UdHOcQDyiEeWz/DHOJp8oerNKUshxgOTdmCOXOy
OcN5DeYQF81BPOpcy5VDPEX+MCiHuAWL12IRERERkRlpPmfY1lNXdC1EiCutUpc6+RJGiKvMMBFv
Lzs+tsgR4jpzEMfbuxchFhERWWb6LBcRERGRzmp5BboWIsRVVqnL1CtCrAjxqO3LHyGOHFZ76c5X
lsSnHOKB2eUQT/vaWqYc4lnOQVylKeU5xKGJP2VTxWJzzCEumoN4ZP0y5RDPcg5iWPAc4sX4dFyM
VoqIiIiIzEHjOcOR9wZXYG1EiKvMMAGKEI+wjBHiKjNMQLcjxCIiIstMn90iIiIi0lkt5AyvD0d8
FSEOQhcjxHXmIIZuRYgjdw5sFCXOKYd4HOUQF+w+RQ5x0RzEMP8cYnhoyjPMl5ObZ7huHuwMc4iL
5iCGZc8hLpqDeER9XcohnrkwWyUiIiIi0oDGQzFONLjiU4Q4JZyoWJcixJOsUgfdihCLiIgsM31W
i4iIiEhnNZ8z7OubuUGKEI+iCLEixGGIgINR6pHYqDsrq3KI+6bJIS7L/lMO8UDzOcQhGtxrnzYP
dpoc4oI5iIf2RTnEU1EO8dTCaIWIiIiISAvayRlOrgDbiRBXWKUOFCFOWeYIcZ1V6tLb85Y5Qiwi
IrLM9NksIiIiIp3VbPjRcznDbUSIq+QPgyLEIyxlhLjCKnWj6rsQIY7cORCln+PcE9FoDnE4/WAW
6uUQV5+DOD52OsohXmSemWfYci+WJnOIi+YgjvfNUg5xQX1dIeUQ1+507Xw6Vjqrmf2CmX3OzG41
s6vNbLuZHW9m15nZ7cnv4+bdWBERERGRWSoNt5jZycDPA7vdfdXM3g9cAOwGrnf3y83sUuBS4LVF
t+U47r3NK8J2IsQ1ZpgARYhHUIR4YNoI8byY2RbgJuAed3+BmR0PvA/YBdwBnO/uD8+1ESJSifqr
SLvqjMR2mNlhwBHAvcB5wFVJ/VXAi2bfPBGZ0CXAbanypcQXr6cB1ydlEQmD+qtIi0rDje5+j5m9
CfgqsAp8zN0/ZmYnufu+ZLf7gJNGHW9mFwMXAxiH4USbQVNFiEcdWEYR4plGiCvMQVylbZNHiGfP
zE4Bng/8LvCLyebzgLOSv68CbqDkPzkRziqH0htylEM8K0U5xEVzEEPHcohr3plFyCGeVX/t8/S9
yt3hJnOIC+cgHnHbS5VDXCt/GJY6h3iqOYhHnWw+Ss+S5AKfBzwVeBJwpJldmN7H3Z0xT7+773X3
Pe6+x0re9ERkJt4C/ArZt53KF69mdpOZ3bSR+1KXiMzFxP0Vsn02jOG9yOKpMjp9LvAVd38QwMw+
CHwvcL+Z7XT3fWa2E3ig/Kays0koQlx0YJlwLiwWOkJcY5W6Km2rGyEmHXmdATN7AfCAu99sZmeN
2sfd3czGXrwCewGOXDmhdnxDRKqbtr8m9Zt91uww9VmRCVQZUX0VOMPMjiBOkzibONF/P3ARcHny
+9p5NVJEKjsTeKGZnQtsB44xs3cz0cWriMyZ+qtIAKrkDH/KzK4BPk0cev0M8VXoUcD7zewVwJ3A
+aW3lcyB2I/0thIhrrRKXao8jiLEQxYxQlxllbqic08fIT4wYq/JuftlwGUASaTpl9z9QjP7fWpe
vLpFHLRUqkRpwqVyiGcle2+K5iCGLuUQTzMHMYSXQzzL/prcIqTmGfaSPNe55hAXzEEMS55DPNUc
xLBcOcQFcxBDMDnElT5B3P31wOtzm9eIo8QiEr7LqXnxKiKtUX8VaVDj4ZTsbBItRIirrFIHihBP
QRHigfII8SNj2zQtd7+B+FvouPvX0MWrSLDUX0Xa0/AIKlkqMjcebHRQXGfpZtCgeAoaFA8swvLL
eT0i9tvj43doNG2i7iMYTj+YVr2lm0FpE9WFljYxC566V/mv3TWaNlFj6WZYsrSJmS7dDAudNlFn
6WZoLW1iET+jRURERERmotnwiRNHhvvaiBDXmnYNFCGeniLEA7r6FBERCYs+m0VERESks5rPGaY3
Pp+mkQjxJAtzgCLE0wsxQlxr6eb0sbnbXsYIsdPjIKmc4bK0sbnmEE8z7dqIcy+wLucQ11q6OXds
FWU5xOFz0s/A0EetcojHnm+mOcR1lm4eVV9qgXKI6yzdDK3lEC/CZ7KIiIiIyFw0Gi5xGDmbxKYm
IsRTLd0MihBPL6gIcZ2lm9M3NqMIsYiIiLRLkWERERER6awWwoXRIO+ojQhxnaWbR7VtkyLE0woi
QlxjholMfQcixBERa16QM9xoDvEsl24ece4F1qkc4hpzEI+snzKHeCGMmrGpX5Xbda45xHWWbh6x
/2LnENdYurlKfSnlEE9LkWERERER6axWVqDrX122EiGus3RzUds2LWKEOKyoWJcjxCIiItIufSaL
iIiISGc1HiJ0os0gZysR4iqr1I1qiyLEc9dKhHiKVeoy9RNGiEPmHnEoSuUM5x9g5RAHSTnEBbtP
mUO8CDz1iJrnHu0mc4jr5sEuUw5x0RzEo45VDnHBsc3kEC/hW4GIiIiISDWN5wzj0eBqs4UIcbVV
6kAR4vY0GSGuskodzC9CLCIiIu1SZFhEREREOquFnOHeZl5SGxHiSqvUgSLEAVCEuF1Oj0O9/eN3
aDKHuDB/uMrJlUM8oBzisfVLFh7y3KPZZA5x4RzEo06Wt8g5xIVzEEOncojr5A9DaznES9b1RURE
RESqaz5nmGgQXG0hQlxplbrMbStC3LZ5RogrzUEMc4sQi4iISLsUGRYRERGRzmo+PuXRZgivjQhx
pVXq0re5lBHiqtdAYYUv5xEhrrVKHcw+Qhwwd6cXrW6WD5UdMNcc4jpzEFc5uXKIBxYnh7hW/jB0
MIc4/u/rwEqutrkc4sI5iEeca6lyiMvefrqUQzzNHMQwfQ7xhKcREREREemMFmaT8MHVaAsR4kqr
1GUalb9tRYjbNssIcaVV6qDTEWIREZFlpsiwiIiIiHRWKyG/ft5SKxHiCqvUpY9RhDhNEeKZR4iD
1qMXjZ9nuNEc4qI5iEE5xFNYpBziqeYghulziBdCUcdpMIe4YA5iWPIc4rL71qUc4qI5iEfVl6mb
QzzhzYqIiIiIdEYr8wz3x+BtRIirrFKXKS9jhHiqOYghtKjYNBHiOqvUZcqzihCLiIhIqxQZFhER
EZHOaiHEl54HsfkIcZVV6mDJI8QzWaUOFCFm6ghx2Bz3QWZwryTPea45xIVzEINyiGcn5BziojmI
Yf45xIunrOPML4e4aA5iWO4c4sI5iEe1VTnE4+vLlOYQT3YzIiIiIiKd0dJlcP9KoIUIcYVV6tLb
lzNCXGWGifRBZcKKpihCLCIiIlUpMiwiIiIinWU+lKgzx5OZPQjsBx5q7KT1nEC4bYOw26e2TeYp
7n5i240YJemvdxL24wdht09tm1yI7Qu2v8LC9Fm1bXIhty/UtlXqs40OhgHM7CZ339PoSSsKuW0Q
dvvUtuUV+uMXcvvUtsmF3r6QhfzYqW2TC7l9IbetCqVJiIiIiEhnaTAsIiIiIp3VxmB4bwvnrCrk
tkHY7VPbllfoj1/I7VPbJhd6+0IW8mOntk0u5PaF3LZSjecMi4iIiIiEQmkSIiIiItJZjQ2Gzewc
M/uimX3JzC5t6rwF7TnVzD5uZp83s8+Z2SXJ9uPN7Dozuz35fVyLbdxiZp8xs4+E1DYzO9bMrjGz
L5jZbWb27FDalrTvF5Ln9FYzu9rMtofUvkUSUr81s3eY2QNmdmtqWxDPa+jvJ0kf+Ccz+79J+94Q
UvuStgT5frdIQuqvSXvUZydrm/prwxoZDJvZFuCPgB8BdgMvMbPdTZy7wAbwGnffDZwBvDJp06XA
9e5+GnB9Um7LJcBtqXIobbsC+Ct3/zbgGcRtDKJtZnYy8PPAHnf/DuIl/C4IpX2LJMB+eyVwTm5b
KM9r6O8na8Bz3P0ZwOnAOWZ2RkDtg3Df7xZCgP0V1Gcnpf7aNHef+w/wbOCvU+XLgMuaOHeNNl4L
PA/4IrAz2bYT+GJL7TmF+AX1HOAjybbW2wY8AfgKSb55anvrbUvOfTJwF3A88SLJHwF+OJT2LdJP
iP0W2AXcmioH+byG9n6Sa9sRwKeB7wmlfaG+3y3ST4j9NWmH+ux07VJ/beCnqTSJ/gCl7+5kWxDM
bBfwTOBTwEnuvi+pug84qaVmvQX4FSBKbQuhbU8FHgTemfyL5G1mdmQgbcPd7wHeBHwV2Ad8w90/
Fkr7FkzQ/TYR3PMa6PtJ/9+atwAPANe5e0jtC/X9bpEsQn+FAJ/XEPus+muzOv8FOjM7CvgA8Gp3
fzRd5/ElTuPTbZjZC4AH3P3mcfu01TbiaOt3AX/i7s8kXl478++QFttGkqd0HvGg/UnAkWZ2YXqf
Ntsn8xPC8xri+0nq/D13P504qvMsM/uOXL3e76RRITyvofZZ9ddmNTUYvgc4NVU+JdnWKjPbStwJ
3uPuH0w2329mO5P6ncRXZU07E3ihmd0BvBd4jpm9O5C23Q3cnVylAlxDPDgOoW0AzwW+4u4Puvs6
8EHgewNq3yIJst/mBPO8Bvx+kuHujwAfJ87lDKF9Ib/fLZJF6K8Q0PO6CH1W/bUZTQ2G/xk4zcye
ambbiL/Q9OGGzj2SmRnwduA2d39zqurDwEXJ3xcR5xE1yt0vc/dT3H0X8WP1t+5+YSBtuw+4y8y+
Ndl0NvD5ENqW+CpwhpkdkTzHZxMn+YfSvkUSXL8dIYjnNeT3EwAzO9HMjk3+3kGcG/mFENoX8vvd
glmE/gqBPK8h91n11xY0lZwMnAv8P+DLwK82dd6C9nwfcRj/s8Atyc+5wDcRJ4bfDvwNcHzL7TyL
QYJ6EG0j/nbrTclj9yHguFDalrTvDcRvHLcC/xM4PKT2LdJPSP0WuJo4D3yd+D8UrwjleQ39/QT4
TuAzSftuBX4j2R5E+1LtDO79bpF+QuqvSXvUZydrm/prwz9agU5EREREOqvzX6ATERERke7SYFhE
REREOkuDYRERERHpLA2GRURERKSzNBgWERERkc7SYFhEREREOkuDYRERERHpLA2GRURERKSz/j+u
V2+kcR9qNQAAAABJRU5ErkJggg==
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To include in PyMC3, a HODLR solver Op would need to be added to either PyMC3 or Theano.  I'm not sure how the gradient implementation would work here, depending on the details I could see this potentially being a little tricky.</p>
<h5 id="References">References<a class="anchor-link" href="#References">¶</a></h5><ul>
<li><a href="https://arxiv.org/pdf/1403.6015.pdf">HODLR solver paper</a></li>
<li><a href="https://github.com/sivaramambikasaran/HODLR">HODLR solver code</a></li>
<li><a href="http://dan.iel.fm/george/current/">George</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Covariance-functions-with-compact-support">Covariance functions with compact support<a class="anchor-link" href="#Covariance-functions-with-compact-support">¶</a></h2><p>If the data being fit doesn't exhibit long-distance correlations, then many elements in the covariance matrix will be near zero.  If the matrix were actually sparse, then linear algebra routines could be applied for computational gains. Simply zeroing out these small values won't in general produce a matrix that is positive definite.</p>
<p>Some kernels have compact support, and so will yield covariance matrices that are sparse when, for example, the domain of the data is large and the function being fit is high frequency or has a small lengthscale.  Including covariance function(s) with compact support should be pretty straightforward in PyMC3.</p>
<h5 id="References:">References:<a class="anchor-link" href="#References:">¶</a></h5><ul>
<li><a href="https://www.amazon.com/Scattered-Approximation-Monographs-Computational-Mathematics/dp/0521843359">Scattered Data Approximation, Wendland (ch 9)</a></li>
<li><a href="http://www.math.iit.edu/~fass/603_ch4.pdf">book chapter</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
                </article>
            </aside><!-- /#featured -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="http://bwengals.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>